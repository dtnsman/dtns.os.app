<html>
    <head>
        <script src="./public/rmb_test.js"></script>
        <script src="./libs/bn.js"></script>
        <script src="./libs/secp256k1.js"></script>
        <script src="./libs/bs58.bundle.js"></script>
        <script src="./libs/bignumber.min.js"></script>
        <script src="./libs/icache-db.js"></script>
        <script src="./libs/ifile-db.js"></script>
        <script src="./libs/md5.js"></script>
        <!-- <script src="./libs/rpc-client.js"></script> -->
        <script src="./libs/simple-signal-client.min.js"></script>
        <script src="./libs/socket.io.min.js"></script>
        <!-- <script src="http://lx.opencom.cn/js/sql-wasm.js"></script> -->
        <!-- <script src="https://cdnjs.cloudflare.com/ajax/libs/sql.js/1.8.0/sql-wasm.js"></script> -->
        <script src="./static/sql-wasm.js"></script>
        <!-- <script src="./libs/sql-wasm.wasm"></script> -->
        <script src="./static/pop_runtime2.js"></script>
        <script src="./static/SQLDB.js"></script>
        <script src="./static/str_filter.js"></script>
        <script src="./static/key_util.js"></script>

        <script src="./static/lx/lianxian_gsb_59872.js"></script>
        <script src="./static/lx/lianxian_msg_59876.js"></script>
        <script src="./static/lx/lianxian_obj_59875.js"></script>
        <script src="./static/lx/lianxian_order_59871.js"></script>
        <script src="./static/lx/lianxian_rmb_59874.js"></script>
        <script src="./static/lx/lianxian_score_59873.js"></script>
        <script src="./static/lx/lianxian_user_59877.js"></script>
        <script src="./static/lx/lianxian_vip_59870.js"></script>

        <script src="./static/dnalink_api_util.js"></script>
        <script src="./static/dnalink_dao_chain.js"></script>
        <script src="./static/dnalink_dao_wallet.js"></script>
        <script src="./static/dnalink_engine.js"></script>
        <script src="./static/dnalink_protocol.js"></script>
        <script src="./static/dnalink_rpc.js"></script>
        <script src="./static/dnalink_rtc_client.js"></script>
        <script src="./static/dnalink_rtc_service.js"></script>
        <script src="./static/dnalink_super_file.js"></script>
        <script src="./static/dnalink_super_meta.js"></script>
        <script src="./static/dnalink_super_websocket.js"></script>
        <!-- <script src="./static/dnalink_rpc_main.js"></script> -->
        <script src="./static/lx_all.js"></script>

        <script src="./js/config.js"></script>
        <script src="./js/RPCClient.js"></script>
        <script src="./js/RPCHost.js"></script>
        <script src="./js/rpc_api_config.js"></script>
        <script src="./js/rpc_api_util.js"></script>

        <script src="./middleware/common_interceptor.js"></script>

        <script src="./clibs/notice_util.js"></script>
        <script src="./controller/mc_logos.js"></script>
        <script src="./controller/fengjing_imgs.js"></script>
        <script src="./controller/address_c.js"></script>
        <script src="./controller/cashout_c.js"></script>
        <script src="./controller/classify_c.js"></script>
        <script src="./controller/console_c.js"></script>
        <script src="./controller/customer_c.js"></script>
        <script src="./controller/fapiao_c.js"></script>
        <script src="./controller/feedback_c.js"></script>
        <script src="./controller/file_c.js"></script>
        <script src="./controller/groupchat_c.js"></script>
        <!-- <script src="./controller/groupchat_live_c.js"></script> -->
        <script src="./controller/gsbshop_c.js"></script>
        <script src="./controller/manager_c.js"></script>
        <script src="./controller/menu_c.js"></script>
        <script src="./controller/obj_c.js"></script>
        <script src="./controller/order_c.js"></script>
        <script src="./controller/post_c.js"></script>
        <script src="./controller/product_c.js"></script>
        <!-- <script src="./controller/pusher_c.js"></script> -->
        <!-- <script src="./controller/qrcode_c.js"></script> -->
        <script src="./controller/shop_c.js"></script>
        <script src="./controller/shopping_c.js"></script>
        <script src="./controller/srcshop_c.js"></script>
        <script src="./controller/store_c.js"></script>
        <script src="./controller/user_c.js"></script>
        <!-- <script src="./controller/user_weixin_c.js"></script> -->

        <script src="./routes/index.js"></script>
        <script src="./js/app.js"></script>
    </head>
    <body>
        <center><h1>《连线-cell-server》</h1></center>
        <br/>
        <span>房间号：</span><input id="roomid"  value="llx"><br/><br/>
        <button onclick="start()">&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;开启&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;</button>&nbsp; &nbsp;
        <button onclick="save()">&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;保存&nbsp; &nbsp; &nbsp;&nbsp; &nbsp; &nbsp;</button>
    <script>
        // window.onbeforeunload = function(){
            
        // }
        const roomMap = new Map()
        function start(){
            let roomid = document.getElementById('roomid').value
            console.log('start roomid:',roomid)
            if(roomMap.has(roomid) || !roomid) return 
            roomMap.set(roomid,roomid)
            console.log('start roomid now:',roomid)
            
            lxStart(roomid,roomid+'-cell')
        }
        function save(alertFlag = false)
        {
            window.m_onbeforeunload_results = []
            let flag = false
            if(typeof m_onbeforeunload == 'function'){
                m_onbeforeunload()
                if(alertFlag) alert('保存成功')
                console.log('保存成功')
                flag = true
            }else{
                console.log('保存函数不存在')
            }
            return {ret:flag,list:m_onbeforeunload_results,msg:flag ? 'success':'save failed'}
        }
        window.m_onbeforeunload_save = save
        start()
    </script>
    </body>
</html>