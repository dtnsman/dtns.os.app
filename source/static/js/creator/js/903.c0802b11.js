"use strict";(self["webpackChunkdtns_creator"]=self["webpackChunkdtns_creator"]||[]).push([[903],{2903:function(e,t,a){a.r(t),a.d(t,{default:function(){return c}});var r=function(){var e=this,t=e._self._c;return t("el-collapse-item",{staticClass:"request-container",attrs:{title:"数据来源（预览生效）",name:"request"}},[t("el-form",[t("el-form-item",{attrs:{label:"请求地址"}},[t("el-input",{on:{blur:e.validateURL},model:{value:e.request.url,callback:function(t){e.$set(e.request,"url","string"===typeof t?t.trim():t)},expression:"request.url"}},[t("template",{slot:"prepend"},[e._v("HTTPS://")])],2)],1),t("el-form-item",{attrs:{label:"请求方法"}},[t("el-select",{model:{value:e.request.method,callback:function(t){e.$set(e.request,"method",t)},expression:"request.method"}},e._l(e.methodOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1)],1),t("el-form-item",{attrs:{label:"请求参数"}},[t("el-select",{attrs:{placeholder:"参数类型"},on:{change:e.onChnage},model:{value:e.request.paramType,callback:function(t){e.$set(e.request,"paramType",t)},expression:"request.paramType"}},e._l(e.dataOptions,(function(e){return t("el-option",{key:e,attrs:{label:e,value:e}})})),1),"array"===e.request.paramType?t("div",{staticClass:"param-container"},[t("p",[e._v("数据项")]),e._l(e.request.data,(function(a,r){return t("div",{key:r,staticClass:"div-delete"},[t("el-input",{attrs:{placeholder:"请输入参数值"},model:{value:e.request.data[r],callback:function(t){e.$set(e.request.data,r,t)},expression:"request.data[index]"}}),t("span",{staticClass:"iconfont icon-shanchu",on:{click:function(t){return e.deleteData(r)}}})],1)})),t("el-button",{on:{click:e.addArrayData}},[e._v("添加")])],2):"string"===e.request.paramType||"object"===e.request.paramType?t("div",{staticClass:"param-container"},[t("p",[e._v("数据项")]),e._l(e.request.data,(function(a,r){return t("div",{key:r,staticClass:"param-object-container"},[t("el-input",{attrs:{placeholder:"参数名"},model:{value:a[0],callback:function(t){e.$set(a,0,t)},expression:"item[0]"}}),t("el-input",{attrs:{placeholder:"参数值"},model:{value:a[1],callback:function(t){e.$set(a,1,t)},expression:"item[1]"}}),t("span",{staticClass:"iconfont icon-shanchu",on:{click:function(t){return e.deleteData(r)}}})],1)})),t("el-button",{on:{click:e.addData}},[e._v("添加")])],2):e._e()],1),t("el-form-item",{attrs:{label:"定时触发"}},[t("el-switch",{model:{value:e.request.series,callback:function(t){e.$set(e.request,"series",t)},expression:"request.series"}}),e.request.series?[t("p",[e._v("触发间隔（毫秒）")]),t("el-input",{attrs:{type:"number"},model:{value:e.request.time,callback:function(t){e.$set(e.request,"time",t)},expression:"request.time"}}),t("p",[e._v("触发次数（0 为无限）")]),t("el-input",{attrs:{type:"number"},model:{value:e.request.requestCount,callback:function(t){e.$set(e.request,"requestCount",t)},expression:"request.requestCount"}})]:e._e()],2)],1)],1)},s=[],n=a(4471),u={data(){return{methodOptions:["GET","POST","PUT","DELETE"],dataOptions:["object","array","string"]}},computed:{request(){return this.$store.state.curComponent.request}},methods:{addArrayData(){this.request.data.push("")},addData(){this.request.data.push(["",""])},deleteData(e){this.request.data.splice(e,1)},onChnage(){"array"===this.request.paramType?this.request.data=[""]:this.request.data=[["",""]]},validateURL(){const e=this.request.url;(e&&/^\d+$/.test(e)||!n._q.test((0,n.Ax)(e)))&&this.$message.error("请输入正确的 URL")}}},o=u,l=a(1001),i=(0,l.Z)(o,r,s,!1,null,"1afacafa",null),c=i.exports},4471:function(e,t,a){a.d(t,{Ax:function(){return l},ZP:function(){return i},_q:function(){return s}});var r=a(4720);const s=/(https?):\/\/[-A-Za-z0-9+&@#/%?=~_|!:,.;]+[-A-Za-z0-9+&@#/%=~_|]/;function n(e){return new Promise(((t,a)=>{const r=new XMLHttpRequest;r.timeout=6e3;let s=l(e.url);"GET"===e.method&&(s+=`${u(e.data)}`),r.open(e.method,s),r.ontimeout=a,r.onerror=a,r.onload=e=>{t(e.target.response)},r.send(JSON.stringify(o(e.data,e.paramType)))}))}function u(e){let t="";return e.forEach((e=>{e[0]&&(t+=`&${e[0]}=${e[1]}`)})),t?"?"+t:""}function o(e,t){if(!e)return"";if("array"===t)return e;const a={};return e.forEach((e=>{e[0]&&(a[e[0]]=e[1])})),a}function l(e){return e.startsWith("http")?e:"https://"+e}function i(e,t,a,u="object"){let o,i=0;const c=e?.url;return(c&&!/^\d+$/.test(c)||s.test(l(c)))&&(e.series?o=setInterval((()=>{0!=e.requestCount&&e.requestCount<=i?clearInterval(o):(i++,n(e,u).then((e=>{t[a]="object"===u||"array"===u?JSON.parse(e):e})).catch((e=>r.Message.error(e?.message||e))))}),e.time):n(e,u).then((e=>{t[a]="object"===u||"array"===u?JSON.parse(e):e})).catch((e=>r.Message.error(e?.message||e)))),function(){clearInterval(o)}}}}]);
//# sourceMappingURL=903.c0802b11.js.map