(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["pages-detail-detail~pages-fork-freeFork~pages-list-forkDetails~pages-list-listDetails"],{2114:function(e,t,a){"use strict";a.r(t);var n=a("4f0b"),r=a("9300");for(var i in r)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(i);a("fb07");var o=a("f0c5"),s=Object(o["a"])(r["default"],n["b"],n["c"],!1,null,"0eab2146",null,!1,n["a"],void 0);t["default"]=s.exports},2909:function(e,t,a){"use strict";a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){return(0,n.default)(e)||(0,r.default)(e)||(0,i.default)(e)||(0,o.default)()};var n=s(a("6005")),r=s(a("db90")),i=s(a("06c5")),o=s(a("3427"));function s(e){return e&&e.__esModule?e:{default:e}}},3427:function(e,t,a){"use strict";a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")},a("d9e2"),a("d401")},"49a3":function(e,t,a){var n=a("7037").default;a("d3b7"),a("e9c4"),a("c740");console.log;var r={lineFeedTags:["<br />","<br/>","\r\n","\n\t","\r","\n"],tagetLineFeedTag:"❤",log:function(e){},showLoading:function(e,t){uni.showLoading({title:e,mask:t||!1})},hideLoading:function(){uni.hideLoading()},showToast:function(e,t){uni.showToast({title:e,icon:t||"none"})},getPosterUrl:function(e){var t=e.backgroundImage,a=e.type;e.formData;return new Promise((function(e,n){var r;if(t)r=t;else switch(a){case 1:r="";break;default:r="";break}r?e(r):n("背景图片路径不存在")}))},shareTypeListSheetArray:{array:[0,1,2,3,4,5]},isArray:function(e){return"[object Array]"===Object.prototype.toString.call(e)},isObject:function(e){return"[object Object]"===Object.prototype.toString.call(e)},isPromise:function(e){return!!e&&("object"===n(e)||"function"===typeof e)&&"function"===typeof e.then},isNull:function(e){return null===e},isUndefined:function(e){return void 0===e},isUndef:function(e){return void 0===e},isNotNull_string:function(e){return null!==e&&void 0!==e&&""!==e},isFn:function(e){return e&&"function"===typeof e},getStorage:function(e,t,a){uni.getStorage({key:e,success:function(e){e.data&&""!=e.data?t&&t(e.data):a&&a()},fail:function(){a&&a()}})},setStorage:function(e,t){JSON.stringify(t),uni.setStorage({key:e,data:t})},setStorageSync:function(e,t){uni.setStorageSync(e,t)},getStorageSync:function(e){return uni.getStorageSync(e)},clearStorageSync:function(){uni.clearStorageSync()},removeStorageSync:function(e){uni.removeStorageSync(e)},getImageInfo:function(e,t,a){e=i(e),uni.getImageInfo({src:e,success:function(e){t&&"function"==typeof t&&t(e)},fail:function(e){a&&"function"==typeof a&&a(e)}})},downloadFile:function(e,t){e=i(e),uni.downloadFile({url:e,success:function(e){t&&"function"==typeof t&&t(e)}})},downloadFile_PromiseFc:function(e){return new Promise((function(t,a){"http"!==e.substring(0,4)?t(e):(e=i(e),uni.downloadFile({url:e,success:function(e){e&&e.tempFilePath?t(e.tempFilePath):a("not find tempFilePath")},fail:function(e){a(e)}}))}))},saveFile:function(e){uni.saveFile({tempFilePath:e,success:function(e){JSON.stringify(e)}})},downLoadAndSaveFile_PromiseFc:function(e){return new Promise((function(t,a){"http"===e.substring(0,4)?(e=i(e),uni.downloadFile({url:e,success:function(e){JSON.stringify(e),e&&e.tempFilePath?t(e.tempFilePath):a("not find tempFilePath")},fail:function(e){a(e)}})):t(e)}))},checkFile_PromiseFc:function(e){return new Promise((function(t,a){uni.getSavedFileList({success:function(a){var n=a.fileList,r=n.findIndex((function(t){return t.filePath===e}));t(r)},fail:function(e){a(e)}})}))},removeSavedFile:function(e){uni.getSavedFileList({success:function(t){var a=t.fileList,n=a.findIndex((function(t){return t.filePath===e}));n>=0&&uni.removeSavedFile({filePath:e})}})},fileNameInPath:function(e){var t=e.split("/");return t[t.length-1]},getImageInfo_PromiseFc:function(e){return new Promise((function(t,a){e=i(e),uni.getImageInfo({src:e,success:function(e){JSON.stringify(e),t(e)},fail:function(e){JSON.stringify(e),a(e)}})}))},previewImage:function(e){"string"==typeof e&&(e=[e]),uni.previewImage({urls:e})},actionSheet:function(e,t){for(var a=[],n=0;n<e.array.length;n++)switch(e.array[n]){case"sinaweibo":a[n]="新浪微博";break;case"qq":a[n]="QQ";break;case"weixin":a[n]="微信";break;case"WXSceneSession":a[n]="微信好友";break;case"WXSenceTimeline":a[n]="微信朋友圈";break;case"WXSceneFavorite":a[n]="微信收藏";break;case 0:a[n]="图文链接";break;case 1:a[n]="纯文字";break;case 2:a[n]="纯图片";break;case 3:a[n]="音乐";break;case 4:a[n]="视频";break;case 5:a[n]="小程序";break;default:break}this.showActionSheet(a,t)},showActionSheet:function(e,t){uni.showActionSheet({itemList:e,success:function(e){t&&"function"==typeof t&&t(e.tapIndex)}})},getProvider:function(e,t,a){var n=this;uni.getProvider({service:e,success:function(r){if(a){var i={};i.array=r.provider,n.actionSheet(i,(function(e){t&&"function"==typeof t&&t(r.provider[e])}))}else if("payment"==e){for(var o=r.provider,s=[],l=0;l<o.length;l++)"wxpay"==o[l]?s[l]={name:"微信支付",value:o[l],img:"/static/image/wei.png"}:"alipay"==o[l]&&(s[l]={name:"支付宝支付",value:o[l],img:"/static/image/ali.png"});t&&"function"==typeof t&&t(s)}else t&&"function"==typeof t&&t(r)}})}};function i(e){return e}e.exports=r},"4b95":function(e,t,a){var n=a("99af1");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var r=a("4f06").default;r("797277bc",n,!0,{sourceMap:!1,shadowMode:!1})},"4f0b":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){}));var n=function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.show?a("v-uni-view",{staticClass:"mask",style:{backgroundColor:e.backgroundColor},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toggleMask.apply(void 0,arguments)},touchmove:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=e.$handleEvent(t),e.stopPrevent.apply(void 0,arguments)}}},[e.showPoster?e._e():a("v-uni-view",{staticClass:"mask-content",style:[{height:e.config.height,transform:e.transform}],on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=e.$handleEvent(t),e.stopPrevent.apply(void 0,arguments)}}},[a("v-uni-scroll-view",{staticClass:"view-content",attrs:{"scroll-y":!0}},[a("v-uni-view",{staticClass:"share-header"},[e._v("分享到")]),a("v-uni-view",{staticClass:"share-list"},e._l(e.shareList,(function(t,n){return a("v-uni-view",{key:n,staticClass:"share-item",on:{click:function(a){arguments[0]=a=e.$handleEvent(a),e.shareToFriend(t)}}},[a("v-uni-image",{attrs:{src:t.icon,mode:""}}),a("v-uni-text",[e._v(e._s(t.text))])],1)})),1)],1),a("v-uni-view",{staticClass:"bottom b-t",on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.toggleMask.apply(void 0,arguments)}}},[e._v("取消")])],1),e.showPoster?a("v-uni-view",{staticClass:"mask-content",staticStyle:{height:"90%",width:"330px","margin-bottom":"50px",background:"rgba(0, 255, 0, 0)"},on:{click:function(t){t.stopPropagation(),t.preventDefault(),arguments[0]=t=e.$handleEvent(t),e.stopPrevent.apply(void 0,arguments)}}},[a("v-uni-view",{staticClass:"cu-modal",class:{show:e.showPoster}},[a("v-uni-view",{staticClass:"cu-dialog",staticStyle:{width:"330px",padding:"5px"}},[a("v-uni-view",{staticClass:"poster-img-box"},[a("v-uni-image",{staticClass:"poster-img",attrs:{src:e.posterImage,mode:"widthFix"}})],1),a("v-uni-view",{directives:[{name:"show",rawName:"v-show",value:e.posterImage,expression:"posterImage"}],staticClass:"poster-btn-box u-m-t-20 u-flex u-row-between u-col-center"},[a("v-uni-button",{staticClass:"cancel-btn u-reset-button",staticStyle:{background:"#ffffff",padding:"10px"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.onClosePoster.apply(void 0,arguments)}}},[e._v("取消")]),a("v-uni-button",{staticClass:"save-btn u-reset-button",staticStyle:{background:"#ffffff",padding:"10px"},on:{click:function(t){arguments[0]=t=e.$handleEvent(t),e.saveImage.apply(void 0,arguments)}}},[e._v(e._s(["wxOfficialAccount","H5"].includes(e.platform)?"长按图片保存":"保存图片"))])],1)],1)],1),e.showPoster?a("shopro-canvas",{ref:"shoproCanvas",attrs:{canvasParams:e.canvasParams},on:{success:function(t){arguments[0]=t=e.$handleEvent(t),e.onSuccess.apply(void 0,arguments)}}}):e._e()],1):e._e()],1):e._e()},r=[]},6005:function(e,t,a){"use strict";a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if(Array.isArray(e))return(0,n.default)(e)};var n=function(e){return e&&e.__esModule?e:{default:e}}(a("6b75"))},7468:function(e,t,a){"use strict";a("7a82");var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("d3b7"),a("e9c4");var r=n(a("c7eb")),i=n(a("1da1")),o=n(a("5530")),s=n(a("49a3")),l=a("f146"),u=n(a("cd43")),c=a("26cb"),d=null,f={components:{},data:function(){return{poster:{},canvasId:"self_canvas"}},props:{canvasParams:{type:Object,default:function(){}},isAutoInit:{type:Boolean,default:!0}},computed:(0,o.default)({},(0,c.mapGetters)(["initShare","userInfo"])),mounted:function(){var e=this;return(0,i.default)((0,r.default)().mark((function t(){return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:d=uni.createCanvasContext(e.canvasId,e),d&&e.isAutoInit&&e.shareFc();case 2:case"end":return t.stop()}}),t)})))()},methods:{shareFc:function(){var e=this;return(0,i.default)((0,r.default)().mark((function t(){var a,n,i,c,f;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return a=e,s.default.showLoading("绘制中..."),n={},a.canvasParams.backgroundImage&&(n={backgroundImage:u.default.checkImgHttp(a.canvasParams.backgroundImage,"bgImage")}),a.canvasParams.background&&(n={background:{width:(null===(i=a.canvasParams.background)||void 0===i?void 0:i.width)||100,height:(null===(c=a.canvasParams.background)||void 0===c?void 0:c.height)||100,backgroundColor:(null===(f=a.canvasParams.background)||void 0===f?void 0:f.color)||"#000"}}),t.prev=5,s.default.log("准备生成:"+new Date),t.next=9,(0,l.getSharePoster)((0,o.default)((0,o.default)({_this:a},n),{},{posterCanvasId:a.canvasId,Context:d,delayTimeScale:10,draw:!1,drawArray:function(e){var t=e.bgObj,n=(e.type,e.bgScale,u.default.initDrawArray(t,a.canvasParams.drawArray));return new Promise((function(e,t){e(n)}))},setCanvasWH:function(t){var a=t.bgObj;t.type,t.bgScale;e.poster=a}}));case 9:return t.sent,t.next=12,a.drawPoster();case 12:t.next=19;break;case 14:t.prev=14,t.t0=t["catch"](5),s.default.hideLoading(),s.default.showToast(JSON.stringify(t.t0)),console.log(JSON.stringify(t.t0));case 19:case"end":return t.stop()}}),t,null,[[5,14]])})))()},drawPoster:function(){var e=this;return(0,i.default)((0,r.default)().mark((function t(){var a;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=e,d.draw(!1,(function(){uni.canvasToTempFilePath({canvasId:a.canvasId,success:function(e){s.default.hideLoading(),a.$emit("success",e.tempFilePath),s.default.log("海报生成成功, 时间:"+new Date+"， 临时路径: "+e.tempFilePath)},fail:function(e){s.default.hideLoading(),console.log("生成异常",e)}},a)}));case 2:case"end":return t.stop()}}),t)})))()}}};t.default=f},9300:function(e,t,a){"use strict";a.r(t);var n=a("bc13"),r=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=r.a},"93aa":function(e,t,a){"use strict";a.d(t,"b",(function(){return n})),a.d(t,"c",(function(){return r})),a.d(t,"a",(function(){}));var n=function(){var e=this.$createElement,t=this._self._c||e;return t("v-uni-view",{staticClass:"invite-poster-content"},[t("v-uni-canvas",{staticClass:"hideCanvas",style:{width:(this.poster.width||1)+"px",height:(this.poster.height||1)+"px"},attrs:{"canvas-id":"self_canvas"}})],1)},r=[]},"99af1":function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\n/* uni.scss */\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 行为相关颜色 */.hideCanvas[data-v-6604a64a]{position:fixed;top:%?-99999?%;left:%?-99999?%;z-index:-99999}',""]),e.exports=t},a10c:function(e,t,a){"use strict";a("7a82");var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.base64ToPath=function(e){return new Promise((function(t,a){if("object"===("undefined"===typeof window?"undefined":(0,r.default)(window))&&"document"in window){e=e.split(",");var n=e[0].match(/:(.*?);/)[1],i=atob(e[1]),o=i.length,s=new Uint8Array(o);while(o--)s[o]=i.charCodeAt(o);return t((window.URL||window.webkitURL).createObjectURL(new Blob([s],{type:n})))}var l=e.match(/data\:\S+\/(\S+);/);l?l=l[1]:a(new Error("base64 error"));var u=Date.now()+"."+l;if("object"!==("undefined"===typeof plus?"undefined":(0,r.default)(plus)))if("object"===("undefined"===typeof wx?"undefined":(0,r.default)(wx))&&wx.canIUse("getFileSystemManager")){var c=wx.env.USER_DATA_PATH+"/"+u;wx.getFileSystemManager().writeFile({filePath:c,data:e.replace(/^data:\S+\/\S+;base64,/,""),encoding:"base64",success:function(){t(c)},fail:function(e){a(e)}})}else a(new Error("not support"));else{var d=new plus.nativeObj.Bitmap("bitmap"+Date.now());d.loadBase64Data(e,(function(){var e="_doc/uniapp_temp/"+u;d.save(e,{},(function(){d.clear(),t(e)}),(function(e){d.clear(),a(e)}))}),(function(e){d.clear(),a(e)}))}}))},t.pathToBase64=function(e){return new Promise((function(t,a){if("object"===("undefined"===typeof window?"undefined":(0,r.default)(window))&&"document"in window){if("function"===typeof FileReader){var n=new XMLHttpRequest;return n.open("GET",e,!0),n.responseType="blob",n.onload=function(){if(200===this.status){var e=new FileReader;e.onload=function(e){t(e.target.result)},e.onerror=a,e.readAsDataURL(this.response)}},n.onerror=a,void n.send()}var i=document.createElement("canvas"),o=i.getContext("2d"),s=new Image;return s.onload=function(){i.width=s.width,i.height=s.height,o.drawImage(s,0,0),t(i.toDataURL()),i.height=i.width=0},s.onerror=a,void(s.src=e)}"object"!==("undefined"===typeof plus?"undefined":(0,r.default)(plus))?"object"===("undefined"===typeof wx?"undefined":(0,r.default)(wx))&&wx.canIUse("getFileSystemManager")?wx.getFileSystemManager().readFile({filePath:e,encoding:"base64",success:function(e){t("data:image/png;base64,"+e.data)},fail:function(e){a(e)}}):a(new Error("not support")):plus.io.resolveLocalFileSystemURL(function(e){if(0===e.indexOf("_www")||0===e.indexOf("_doc")||0===e.indexOf("_documents")||0===e.indexOf("_downloads"))return e;if(0===e.indexOf("file://"))return e;if(0===e.indexOf("/storage/emulated/0/"))return e;if(0===e.indexOf("/")){var t=plus.io.convertAbsoluteFileSystem(e);if(t!==e)return t;e=e.substr(1)}return"_www/"+e}(e),(function(e){e.file((function(e){var n=new plus.io.FileReader;n.onload=function(e){t(e.target.result)},n.onerror=function(e){a(e)},n.readAsDataURL(e)}),(function(e){a(e)}))}),(function(e){a(e)}))}))};var r=n(a("53ca"));a("c975"),a("d3b7"),a("d9e2"),a("d401"),a("ac1f"),a("466d"),a("81b2"),a("0eb6"),a("b7ef"),a("8bd4"),a("ace4"),a("5cc6"),a("907a"),a("9a8c"),a("a975"),a("735e"),a("c1ac"),a("d139"),a("3a7b"),a("986a"),a("1d02"),a("d5d6"),a("82f8"),a("e91f"),a("60bd"),a("5f96"),a("3280"),a("3fcc"),a("ca91"),a("25a1"),a("cd26"),a("3c5d"),a("2954"),a("649e"),a("219c"),a("b39a"),a("72f7"),a("3ca3"),a("ddb0"),a("2b3d"),a("9861"),a("5319")},a384:function(e,t,a){"use strict";a.r(t);var n=a("7468"),r=a.n(n);for(var i in n)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return n[e]}))}(i);t["default"]=r.a},b0c7:function(e,t,a){"use strict";a.r(t);var n=a("93aa"),r=a("a384");for(var i in r)["default"].indexOf(i)<0&&function(e){a.d(t,e,(function(){return r[e]}))}(i);a("ea91");var o=a("f0c5"),s=Object(o["a"])(r["default"],n["b"],n["c"],!1,null,"6604a64a",null,!1,n["a"],void 0);t["default"]=s.exports},bc13:function(e,t,a){"use strict";a("7a82");var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=n(a("c7eb")),i=n(a("1da1"));a("a9e3"),a("caad");var o=n(a("b0c7")),s={components:{ShoproCanvas:o.default},data:function(){return{transform:"translateY(50vh)",timer:0,backgroundColor:"rgba(0,0,0,0)",show:!1,showShare:!1,showPoster:!1,posterImage:"",platform:"H5",config:{},canvasParams:{}}},props:{contentHeight:{type:Number,default:0},hasTabbar:{type:Boolean,default:!1},shareList:{type:Array,default:function(){return[]}},posterType:{type:String,default:""},posterInfo:{type:Object,default:function(){}}},created:function(){var e=this;return(0,i.default)((0,r.default)().mark((function t(){var a,n;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:a=uni.upx2px(e.contentHeight)+"px",n=uni.upx2px(480)+"px",e.config={height:a,height2:n,transform:"translateY(".concat(a,")"),transform2:"translateY(".concat(n,")"),backgroundColor:"rgba(0,0,0,.4)"},e.transform=e.config.transform;case 4:case"end":return t.stop()}}),t)})))()},methods:{toggleMask:function(){var e=this;if(1!=this.timer){if(this.timer=1,setTimeout((function(){e.timer=0}),500),this.show)return this.transform=this.config.transform,this.backgroundColor="rgba(0,0,0,0)",void setTimeout((function(){e.show=!1,e.hasTabbar&&uni.showTabBar()}),200);this.show=!0,this.hasTabbar?uni.hideTabBar({success:function(){setTimeout((function(){e.backgroundColor=e.config.backgroundColor,e.transform="translateY(0px)"}),10)}}):setTimeout((function(){e.backgroundColor=e.config.backgroundColor,e.transform="translateY(0px)"}),10)}},stopPrevent:function(){},saveImage:function(){var e=this;return(0,i.default)((0,r.default)().mark((function t(){var a,n;return(0,r.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(a=e,!["wxOfficialAccount","H5"].includes(e.platform)){t.next=4;break}return e.$u.toast("长按图片保存"),t.abrupt("return",!1);case 4:return t.next=6,new Auth("writePhotosAlbum").check();case 6:n=t.sent,n&&uni.saveImageToPhotosAlbum({filePath:a.posterImage,success:function(t){e.$u.toast("保存成功"),e.showPoster=!1},fail:function(t){console.log("图片保存失败:",t),e.$u.toast("保存失败")}});case 8:case"end":return t.stop()}}),t)})))()},shareToFriend:function(e){var t=this;return(0,i.default)((0,r.default)().mark((function a(){return(0,r.default)().wrap((function(a){while(1)switch(a.prev=a.next){case 0:if(2!=e.type){a.next=4;break}try{navigator.clipboard.writeText(window.location.href),console.log("链接内容已复制",window.location.href),t.$api.msg("链接内容已复制",5e3),t.show=!1}catch(n){console.log("copy-exception:"+n),t.$api.msg("链接内容复制失败，原因（可能无权限）",5e3)}a.next=13;break;case 4:return a.next=6,imageDb.getDataByKey(t.posterInfo.work_image);case 6:t.goodsImageSrc=a.sent,t.goodsImageSrc=t.goodsImageSrc?t.goodsImageSrc.data:"",console.log("this.goodsImageSrc:",t.goodsImageSrc),t.canvasParams=t.getPosterFormatter(),console.log("this.canvasParams:",t.canvasParams),console.log("showPoster is true"),t.showPoster=!0;case 13:case"end":return a.stop()}}),a)})))()},onSuccess:function(e){console.log("onSuccess-this.posterImage :",e),this.posterImage=e},onClosePoster:function(){this.showPoster=!1,this.show=!1},getPosterFormatter:function(){var e={};switch(this.posterType){case"goods":e={backgroundImage:"http://www.nftlist.com.cn/image/view?img_kind=open&filename=obj_imgopen28ALBM5un",drawArray:[{name:"goodsImage",type:"image",url:this.goodsImageSrc,alpha:1,isBgCenter:!0,dy:280,dWidth:720,dHeight:720},{type:"text",text:this.posterInfo.work_name,size:40,color:"#333",alpha:1,textAlign:"left",textBaseline:"middle",fontWeight:"bold",lineFeed:{maxWidth:620,lineHeight:40,lineNum:2},dx:60,dy:1035},{type:"text",text:this.posterInfo.creatorInfo.user_name,size:29,color:"#333",alpha:1,textAlign:"left",textBaseline:"middle",fontWeight:"normal",fontFamily:"OPPOSANS",dx:200,dy:1131.5},{type:"text",text:this.posterInfo.forkUserInfo.user_name,size:29,color:"#333",alpha:1,textAlign:"left",textBaseline:"middle",fontWeight:"normal",fontFamily:"OPPOSANS",dx:200,dy:1185},{type:"text",text:this.posterInfo.obj_id,size:29,color:"#333",alpha:1,textAlign:"left",textBaseline:"middle",fontWeight:"normal",fontFamily:"OPPOSANS",dx:210,dy:1315},{type:"text",text:"￥".concat(this.posterInfo.rmb_price),size:29,color:"#E1212B",alpha:1,textAlign:"left",textBaseline:"middle",fontWeight:"normal",fontFamily:"OPPOSANS",dx:200,dy:1250},{type:"qrcode",text:location.href,size:280,dx:30,dy:1430}]};break;default:console.log("%cerr:没有此类型海报数据","color:green;background:yellow");break}return e}}};t.default=s},c565:function(e,t,a){var n=a("c7ac");n.__esModule&&(n=n.default),"string"===typeof n&&(n=[[e.i,n,""]]),n.locals&&(e.exports=n.locals);var r=a("4f06").default;r("557931cc",n,!0,{sourceMap:!1,shadowMode:!1})},c7ac:function(e,t,a){var n=a("24fb");t=n(!1),t.push([e.i,'@charset "UTF-8";\n/* uni.scss */\n/* 页面左右间距 */\n/* 文字尺寸 */\n/*文字颜色*/\n/* 边框颜色 */\n/* 图片加载中颜色 */\n/* 行为相关颜色 */.mask[data-v-0eab2146]{position:fixed;left:0;top:0;right:0;bottom:0;display:flex;justify-content:center;align-items:flex-end;z-index:998;transition:.3s}.mask .bottom[data-v-0eab2146]{position:absolute;left:0;bottom:0;display:flex;justify-content:center;align-items:center;width:100%;height:%?90?%;background:#fff;z-index:9;font-size:%?30?%;color:#303133}.mask-content[data-v-0eab2146]{width:100%;height:%?580?%;transition:.3s;background:#fff}.mask-content.has-bottom[data-v-0eab2146]{padding-bottom:%?90?%}.mask-content .view-content[data-v-0eab2146]{height:100%}.share-header[data-v-0eab2146]{height:%?110?%;font-size:%?30?%;color:font-color-dark;display:flex;align-items:center;justify-content:center;padding-top:%?10?%}.share-header[data-v-0eab2146]:before, .share-header[data-v-0eab2146]:after{content:"";width:%?240?%;heighg:0;border-top:1px solid #e4e7ed;-webkit-transform:scaleY(.5);transform:scaleY(.5);margin-right:%?30?%}.share-header[data-v-0eab2146]:after{margin-left:%?30?%;margin-right:0}.share-list[data-v-0eab2146]{display:flex;flex-wrap:wrap}.share-item[data-v-0eab2146]{min-width:33.33%;display:flex;flex-direction:column;justify-content:center;align-items:center;height:%?180?%}.share-item uni-image[data-v-0eab2146]{width:%?80?%;height:%?80?%;margin-bottom:%?16?%}.share-item uni-text[data-v-0eab2146]{font-size:%?28?%;color:#606266}',""]),e.exports=t},cb29:function(e,t,a){var n=a("23e7"),r=a("81d5"),i=a("44d2");n({target:"Array",proto:!0},{fill:r}),i("fill")},cd43:function(e,t,a){"use strict";a("7a82");var n=a("4ea4").default;Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0,a("d3b7"),a("a9e3"),a("159b"),a("14d9");var r=n(a("ade3")),i=n(a("c7eb")),o=n(a("1da1")),s={checkImgHttp:function(e,t){var a=this;return(0,o.default)((0,i.default)().mark((function n(){var r,o,s,l;return(0,i.default)().wrap((function(n){while(1)switch(n.prev=n.next){case 0:return n.next=2,a.getImageInfo_PromiseFc(e);case 2:if(r=n.sent,o="",r){n.next=20;break}uni.hideLoading(),n.t0=t,n.next="avatar"===n.t0?9:"bgImage"===n.t0?11:"wxCode"===n.t0?13:"goodsImage"===n.t0?15:17;break;case 9:return console.log("%cerr:海报头像图片错误: "+e,"color:green;background:yellow"),n.abrupt("break",18);case 11:return console.log("%cerr:海报背景图片错误: "+e,"color:green;background:yellow"),n.abrupt("break",18);case 13:return console.log("%cerr:海报微信二维码图片错误: "+e,"color:green;background:yellow"),n.abrupt("break",18);case 15:return console.log("%cerr:海报商品图片错误: "+e,"color:green;background:yellow"),n.abrupt("break",18);case 17:return n.abrupt("break",18);case 18:n.next=24;break;case 20:s=e.split("://"),l="https:"==window.location.protocol,s[0]=l?"https":"http",o=s.join("://");case 24:return n.abrupt("return",o);case 25:case"end":return n.stop()}}),n)})))()},getImageInfo_PromiseFc:function(e){var t=this;return new Promise((function(a,n){e=t.checkMPUrl(e),uni.getImageInfo({src:e,success:function(e){a(1)},fail:function(e){console.log(e),a(0)}})}))},checkMPUrl:function(e){return e},getScale:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0;return Number(e.width*(t/e.width).toFixed(2))},initDrawArray:function(e,t){var a=this,n=this,i=[];return t.forEach((function(t){var o,s,l,u,c,d,f,g,h,m,p,b,v,y;switch(t.type){case"text":i.push((h={type:"text",text:t.text,size:n.getScale(e,t.size)||50,color:t.color||"black",alpha:t.alpha||1,textAlign:t.textAlign||"left",textBaseline:t.textBaseline||"middle",dx:n.getScale(e,t.dx)||0,dy:n.getScale(e,t.dy+t.size)||0},(0,r.default)(h,t.lineFeed?"lineFeed":"",{maxWidth:(null===(o=t.lineFeed)||void 0===o?void 0:o.maxWidth)&&n.getScale(e,t.lineFeed.maxWidth)||e.width,lineHeight:(null===(s=t.lineFeed)||void 0===s?void 0:s.lineHeight)&&n.getScale(e,t.lineFeed.lineHeight)||50,lineNum:(null===(l=t.lineFeed)||void 0===l?void 0:l.lineNum)||-1,dx:(null===(u=t.lineFeed)||void 0===u?void 0:u.dx)||-1}),(0,r.default)(h,"infoCallBack",(function(a){return t.isBgCenter?{dx:(e.width-a)/2}:{}})),(0,r.default)(h,t.lineThrough?"lineThrough":"",{width:(null===(c=t.lineThrough)||void 0===c?void 0:c.width)||t.size/10,style:(null===(d=t.lineThrough)||void 0===d?void 0:d.style)||t.color,alpha:(null===(f=t.lineThrough)||void 0===f?void 0:f.alpha)||1,cap:(null===(g=t.lineThrough)||void 0===g?void 0:g.cap)||"butt"}),(0,r.default)(h,"fontStyle",t.fontStyle||"normal"),(0,r.default)(h,"fontVariant",t.fontVariant||"normal"),(0,r.default)(h,"fontWeight",t.fontWeight||"normal"),(0,r.default)(h,"fontFamily",t.fontFamily||"sans-serif"),h));break;case"qrcode":i.push({type:"qrcode",text:String(t.text||"")||"",size:Number(n.getScale(e,t.size)||0)||200,background:String(t.background||"")||"#ffffff",foreground:String(t.foreground||"")||"#000000",correctLevel:Number(t.correctLevel||0)||3,image:String(t.image||"")||"",imageSize:Number(n.getScale(e,t.imageSize)||0)||40,dx:t.isBgCenter?(e.width-t.size)/2:Number(n.getScale(e,t.dx)||0)||0,dy:Number(n.getScale(e,t.dy)||0)||0});break;case"image":i.push((y={type:"image",url:a.checkImgHttp(t.url,t.name),dWidth:Number(n.getScale(e,t.dWidth)||0)||100,dHeight:Number(n.getScale(e,t.dHeight)||0)||100,sWidth:Number(n.getScale(e,t.sWidth)||0)||100,sHeight:Number(n.getScale(e,t.sHeight)||0)||100,dx:Number(n.getScale(e,t.dx)||0)||0,dy:Number(n.getScale(e,t.dy)||0)||0,sx:Number(n.getScale(e,t.sx)||0)||0,sy:Number(n.getScale(e,t.sy)||0)||0},(0,r.default)(y,t.circleSet?"circleSet":"",{r:Number((null===(m=t.circleSet)||void 0===m?void 0:m.r)&&n.getScale(e,t.circleSet.r)||0),x:Number((null===(p=t.circleSet)||void 0===p?void 0:p.x)&&n.getScale(e,t.circleSet.x)||0),y:Number((null===(b=t.circleSet)||void 0===b?void 0:b.y)&&n.getScale(e,t.circleSet.y)||0)}),(0,r.default)(y,t.roundRectSet?"roundRectSet":"",{r:Number((null===(v=t.roundRectSet)||void 0===v?void 0:v.r)&&n.getScale(e,t.roundRectSet.r)||0)}),(0,r.default)(y,"infoCallBack",(function(a){if(t.isBgCenter)return{dx:(e.width-t.dWidth)/2}})),y));break;default:_app.log("暂无次类型");break}})),i}};t.default=s},db90:function(e,t,a){"use strict";a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){if("undefined"!==typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)},a("a4d3"),a("e01a"),a("d3b7"),a("d28b"),a("3ca3"),a("ddb0"),a("a630")},e196:function(e,t,a){"use strict";function n(e){var t,a,n;return e<128?[e]:e<2048?(t=192+(e>>6),a=128+(63&e),[t,a]):(t=224+(e>>12),a=128+(e>>6&63),n=128+(63&e),[t,a,n])}function r(e,t){this.typeNumber=-1,this.errorCorrectLevel=t,this.modules=null,this.moduleCount=0,this.dataCache=null,this.rsBlocks=null,this.totalDataCount=-1,this.data=e,this.utf8bytes=function(e){for(var t=[],a=0;a<e.length;a++)for(var r=e.charCodeAt(a),i=n(r),o=0;o<i.length;o++)t.push(i[o]);return t}(e),this.make()}a("7a82"),Object.defineProperty(t,"__esModule",{value:!0}),t.default=r,a("14d9"),a("d9e2"),a("d401"),r.prototype={constructor:r,getModuleCount:function(){return this.moduleCount},make:function(){this.getRightType(),this.dataCache=this.createData(),this.createQrcode()},makeImpl:function(e){this.moduleCount=4*this.typeNumber+17,this.modules=new Array(this.moduleCount);for(var t=0;t<this.moduleCount;t++)this.modules[t]=new Array(this.moduleCount);this.setupPositionProbePattern(0,0),this.setupPositionProbePattern(this.moduleCount-7,0),this.setupPositionProbePattern(0,this.moduleCount-7),this.setupPositionAdjustPattern(),this.setupTimingPattern(),this.setupTypeInfo(!0,e),this.typeNumber>=7&&this.setupTypeNumber(!0),this.mapData(this.dataCache,e)},setupPositionProbePattern:function(e,t){for(var a=-1;a<=7;a++)if(!(e+a<=-1||this.moduleCount<=e+a))for(var n=-1;n<=7;n++)t+n<=-1||this.moduleCount<=t+n||(this.modules[e+a][t+n]=0<=a&&a<=6&&(0==n||6==n)||0<=n&&n<=6&&(0==a||6==a)||2<=a&&a<=4&&2<=n&&n<=4)},createQrcode:function(){for(var e=0,t=0,a=null,n=0;n<8;n++){this.makeImpl(n);var r=s.getLostPoint(this);(0==n||e>r)&&(e=r,t=n,a=this.modules)}this.modules=a,this.setupTypeInfo(!1,t),this.typeNumber>=7&&this.setupTypeNumber(!1)},setupTimingPattern:function(){for(var e=8;e<this.moduleCount-8;e++)null==this.modules[e][6]&&(this.modules[e][6]=e%2==0,null==this.modules[6][e]&&(this.modules[6][e]=e%2==0))},setupPositionAdjustPattern:function(){for(var e=s.getPatternPosition(this.typeNumber),t=0;t<e.length;t++)for(var a=0;a<e.length;a++){var n=e[t],r=e[a];if(null==this.modules[n][r])for(var i=-2;i<=2;i++)for(var o=-2;o<=2;o++)this.modules[n+i][r+o]=-2==i||2==i||-2==o||2==o||0==i&&0==o}},setupTypeNumber:function(e){for(var t=s.getBCHTypeNumber(this.typeNumber),a=0;a<18;a++){var n=!e&&1==(t>>a&1);this.modules[Math.floor(a/3)][a%3+this.moduleCount-8-3]=n,this.modules[a%3+this.moduleCount-8-3][Math.floor(a/3)]=n}},setupTypeInfo:function(e,t){for(var a=i[this.errorCorrectLevel]<<3|t,n=s.getBCHTypeInfo(a),r=0;r<15;r++){var o=!e&&1==(n>>r&1);r<6?this.modules[r][8]=o:r<8?this.modules[r+1][8]=o:this.modules[this.moduleCount-15+r][8]=o;o=!e&&1==(n>>r&1);r<8?this.modules[8][this.moduleCount-r-1]=o:r<9?this.modules[8][15-r-1+1]=o:this.modules[8][15-r-1]=o}this.modules[this.moduleCount-8][8]=!e},createData:function(){var e=new f,t=this.typeNumber>9?16:8;e.put(4,4),e.put(this.utf8bytes.length,t);for(var a=0,n=this.utf8bytes.length;a<n;a++)e.put(this.utf8bytes[a],8);e.length+4<=8*this.totalDataCount&&e.put(0,4);while(e.length%8!=0)e.putBit(!1);while(1){if(e.length>=8*this.totalDataCount)break;if(e.put(r.PAD0,8),e.length>=8*this.totalDataCount)break;e.put(r.PAD1,8)}return this.createBytes(e)},createBytes:function(e){for(var t=0,a=0,n=0,r=this.rsBlock.length/3,i=new Array,o=0;o<r;o++)for(var l=this.rsBlock[3*o+0],u=this.rsBlock[3*o+1],d=this.rsBlock[3*o+2],f=0;f<l;f++)i.push([d,u]);for(var g=new Array(i.length),h=new Array(i.length),m=0;m<i.length;m++){var p=i[m][0],b=i[m][1]-p;a=Math.max(a,p),n=Math.max(n,b),g[m]=new Array(p);for(o=0;o<g[m].length;o++)g[m][o]=255&e.buffer[o+t];t+=p;var v=s.getErrorCorrectPolynomial(b),y=new c(g[m],v.getLength()-1),x=y.mod(v);h[m]=new Array(v.getLength()-1);for(o=0;o<h[m].length;o++){var w=o+x.getLength()-h[m].length;h[m][o]=w>=0?x.get(w):0}}var k=new Array(this.totalDataCount),S=0;for(o=0;o<a;o++)for(m=0;m<i.length;m++)o<g[m].length&&(k[S++]=g[m][o]);for(o=0;o<n;o++)for(m=0;m<i.length;m++)o<h[m].length&&(k[S++]=h[m][o]);return k},mapData:function(e,t){for(var a=-1,n=this.moduleCount-1,r=7,i=0,o=this.moduleCount-1;o>0;o-=2){6==o&&o--;while(1){for(var l=0;l<2;l++)if(null==this.modules[n][o-l]){var u=!1;i<e.length&&(u=1==(e[i]>>>r&1));var c=s.getMask(t,n,o-l);c&&(u=!u),this.modules[n][o-l]=u,r--,-1==r&&(i++,r=7)}if(n+=a,n<0||this.moduleCount<=n){n-=a,a=-a;break}}}}},r.PAD0=236,r.PAD1=17;for(var i=[1,0,3,2],o={PATTERN000:0,PATTERN001:1,PATTERN010:2,PATTERN011:3,PATTERN100:4,PATTERN101:5,PATTERN110:6,PATTERN111:7},s={PATTERN_POSITION_TABLE:[[],[6,18],[6,22],[6,26],[6,30],[6,34],[6,22,38],[6,24,42],[6,26,46],[6,28,50],[6,30,54],[6,32,58],[6,34,62],[6,26,46,66],[6,26,48,70],[6,26,50,74],[6,30,54,78],[6,30,56,82],[6,30,58,86],[6,34,62,90],[6,28,50,72,94],[6,26,50,74,98],[6,30,54,78,102],[6,28,54,80,106],[6,32,58,84,110],[6,30,58,86,114],[6,34,62,90,118],[6,26,50,74,98,122],[6,30,54,78,102,126],[6,26,52,78,104,130],[6,30,56,82,108,134],[6,34,60,86,112,138],[6,30,58,86,114,142],[6,34,62,90,118,146],[6,30,54,78,102,126,150],[6,24,50,76,102,128,154],[6,28,54,80,106,132,158],[6,32,58,84,110,136,162],[6,26,54,82,110,138,166],[6,30,58,86,114,142,170]],G15:1335,G18:7973,G15_MASK:21522,getBCHTypeInfo:function(e){var t=e<<10;while(s.getBCHDigit(t)-s.getBCHDigit(s.G15)>=0)t^=s.G15<<s.getBCHDigit(t)-s.getBCHDigit(s.G15);return(e<<10|t)^s.G15_MASK},getBCHTypeNumber:function(e){var t=e<<12;while(s.getBCHDigit(t)-s.getBCHDigit(s.G18)>=0)t^=s.G18<<s.getBCHDigit(t)-s.getBCHDigit(s.G18);return e<<12|t},getBCHDigit:function(e){var t=0;while(0!=e)t++,e>>>=1;return t},getPatternPosition:function(e){return s.PATTERN_POSITION_TABLE[e-1]},getMask:function(e,t,a){switch(e){case o.PATTERN000:return(t+a)%2==0;case o.PATTERN001:return t%2==0;case o.PATTERN010:return a%3==0;case o.PATTERN011:return(t+a)%3==0;case o.PATTERN100:return(Math.floor(t/2)+Math.floor(a/3))%2==0;case o.PATTERN101:return t*a%2+t*a%3==0;case o.PATTERN110:return(t*a%2+t*a%3)%2==0;case o.PATTERN111:return(t*a%3+(t+a)%2)%2==0;default:throw new Error("bad maskPattern:"+e)}},getErrorCorrectPolynomial:function(e){for(var t=new c([1],0),a=0;a<e;a++)t=t.multiply(new c([1,l.gexp(a)],0));return t},getLostPoint:function(e){for(var t=e.getModuleCount(),a=0,n=0,r=0;r<t;r++)for(var i=0,o=e.modules[r][0],s=0;s<t;s++){var l=e.modules[r][s];if(s<t-6&&l&&!e.modules[r][s+1]&&e.modules[r][s+2]&&e.modules[r][s+3]&&e.modules[r][s+4]&&!e.modules[r][s+5]&&e.modules[r][s+6]&&(s<t-10?e.modules[r][s+7]&&e.modules[r][s+8]&&e.modules[r][s+9]&&e.modules[r][s+10]&&(a+=40):s>3&&e.modules[r][s-1]&&e.modules[r][s-2]&&e.modules[r][s-3]&&e.modules[r][s-4]&&(a+=40)),r<t-1&&s<t-1){var u=0;l&&u++,e.modules[r+1][s]&&u++,e.modules[r][s+1]&&u++,e.modules[r+1][s+1]&&u++,0!=u&&4!=u||(a+=3)}o^l?i++:(o=l,i>=5&&(a+=3+i-5),i=1),l&&n++}for(s=0;s<t;s++)for(i=0,o=e.modules[0][s],r=0;r<t;r++){l=e.modules[r][s];r<t-6&&l&&!e.modules[r+1][s]&&e.modules[r+2][s]&&e.modules[r+3][s]&&e.modules[r+4][s]&&!e.modules[r+5][s]&&e.modules[r+6][s]&&(r<t-10?e.modules[r+7][s]&&e.modules[r+8][s]&&e.modules[r+9][s]&&e.modules[r+10][s]&&(a+=40):r>3&&e.modules[r-1][s]&&e.modules[r-2][s]&&e.modules[r-3][s]&&e.modules[r-4][s]&&(a+=40)),o^l?i++:(o=l,i>=5&&(a+=3+i-5),i=1)}var c=Math.abs(100*n/t/t-50)/5;return a+=10*c,a}},l={glog:function(e){if(e<1)throw new Error("glog("+e+")");return l.LOG_TABLE[e]},gexp:function(e){while(e<0)e+=255;while(e>=256)e-=255;return l.EXP_TABLE[e]},EXP_TABLE:new Array(256),LOG_TABLE:new Array(256)},u=0;u<8;u++)l.EXP_TABLE[u]=1<<u;for(u=8;u<256;u++)l.EXP_TABLE[u]=l.EXP_TABLE[u-4]^l.EXP_TABLE[u-5]^l.EXP_TABLE[u-6]^l.EXP_TABLE[u-8];for(u=0;u<255;u++)l.LOG_TABLE[l.EXP_TABLE[u]]=u;function c(e,t){if(void 0==e.length)throw new Error(e.length+"/"+t);var a=0;while(a<e.length&&0==e[a])a++;this.num=new Array(e.length-a+t);for(var n=0;n<e.length-a;n++)this.num[n]=e[n+a]}c.prototype={get:function(e){return this.num[e]},getLength:function(){return this.num.length},multiply:function(e){for(var t=new Array(this.getLength()+e.getLength()-1),a=0;a<this.getLength();a++)for(var n=0;n<e.getLength();n++)t[a+n]^=l.gexp(l.glog(this.get(a))+l.glog(e.get(n)));return new c(t,0)},mod:function(e){var t=this.getLength(),a=e.getLength();if(t-a<0)return this;for(var n=new Array(t),r=0;r<t;r++)n[r]=this.get(r);while(n.length>=a){var i=l.glog(n[0])-l.glog(e.get(0));for(r=0;r<e.getLength();r++)n[r]^=l.gexp(l.glog(e.get(r))+i);while(0==n[0])n.shift()}return new c(n,0)}};var d=[[1,26,19],[1,26,16],[1,26,13],[1,26,9],[1,44,34],[1,44,28],[1,44,22],[1,44,16],[1,70,55],[1,70,44],[2,35,17],[2,35,13],[1,100,80],[2,50,32],[2,50,24],[4,25,9],[1,134,108],[2,67,43],[2,33,15,2,34,16],[2,33,11,2,34,12],[2,86,68],[4,43,27],[4,43,19],[4,43,15],[2,98,78],[4,49,31],[2,32,14,4,33,15],[4,39,13,1,40,14],[2,121,97],[2,60,38,2,61,39],[4,40,18,2,41,19],[4,40,14,2,41,15],[2,146,116],[3,58,36,2,59,37],[4,36,16,4,37,17],[4,36,12,4,37,13],[2,86,68,2,87,69],[4,69,43,1,70,44],[6,43,19,2,44,20],[6,43,15,2,44,16],[4,101,81],[1,80,50,4,81,51],[4,50,22,4,51,23],[3,36,12,8,37,13],[2,116,92,2,117,93],[6,58,36,2,59,37],[4,46,20,6,47,21],[7,42,14,4,43,15],[4,133,107],[8,59,37,1,60,38],[8,44,20,4,45,21],[12,33,11,4,34,12],[3,145,115,1,146,116],[4,64,40,5,65,41],[11,36,16,5,37,17],[11,36,12,5,37,13],[5,109,87,1,110,88],[5,65,41,5,66,42],[5,54,24,7,55,25],[11,36,12],[5,122,98,1,123,99],[7,73,45,3,74,46],[15,43,19,2,44,20],[3,45,15,13,46,16],[1,135,107,5,136,108],[10,74,46,1,75,47],[1,50,22,15,51,23],[2,42,14,17,43,15],[5,150,120,1,151,121],[9,69,43,4,70,44],[17,50,22,1,51,23],[2,42,14,19,43,15],[3,141,113,4,142,114],[3,70,44,11,71,45],[17,47,21,4,48,22],[9,39,13,16,40,14],[3,135,107,5,136,108],[3,67,41,13,68,42],[15,54,24,5,55,25],[15,43,15,10,44,16],[4,144,116,4,145,117],[17,68,42],[17,50,22,6,51,23],[19,46,16,6,47,17],[2,139,111,7,140,112],[17,74,46],[7,54,24,16,55,25],[34,37,13],[4,151,121,5,152,122],[4,75,47,14,76,48],[11,54,24,14,55,25],[16,45,15,14,46,16],[6,147,117,4,148,118],[6,73,45,14,74,46],[11,54,24,16,55,25],[30,46,16,2,47,17],[8,132,106,4,133,107],[8,75,47,13,76,48],[7,54,24,22,55,25],[22,45,15,13,46,16],[10,142,114,2,143,115],[19,74,46,4,75,47],[28,50,22,6,51,23],[33,46,16,4,47,17],[8,152,122,4,153,123],[22,73,45,3,74,46],[8,53,23,26,54,24],[12,45,15,28,46,16],[3,147,117,10,148,118],[3,73,45,23,74,46],[4,54,24,31,55,25],[11,45,15,31,46,16],[7,146,116,7,147,117],[21,73,45,7,74,46],[1,53,23,37,54,24],[19,45,15,26,46,16],[5,145,115,10,146,116],[19,75,47,10,76,48],[15,54,24,25,55,25],[23,45,15,25,46,16],[13,145,115,3,146,116],[2,74,46,29,75,47],[42,54,24,1,55,25],[23,45,15,28,46,16],[17,145,115],[10,74,46,23,75,47],[10,54,24,35,55,25],[19,45,15,35,46,16],[17,145,115,1,146,116],[14,74,46,21,75,47],[29,54,24,19,55,25],[11,45,15,46,46,16],[13,145,115,6,146,116],[14,74,46,23,75,47],[44,54,24,7,55,25],[59,46,16,1,47,17],[12,151,121,7,152,122],[12,75,47,26,76,48],[39,54,24,14,55,25],[22,45,15,41,46,16],[6,151,121,14,152,122],[6,75,47,34,76,48],[46,54,24,10,55,25],[2,45,15,64,46,16],[17,152,122,4,153,123],[29,74,46,14,75,47],[49,54,24,10,55,25],[24,45,15,46,46,16],[4,152,122,18,153,123],[13,74,46,32,75,47],[48,54,24,14,55,25],[42,45,15,32,46,16],[20,147,117,4,148,118],[40,75,47,7,76,48],[43,54,24,22,55,25],[10,45,15,67,46,16],[19,148,118,6,149,119],[18,75,47,31,76,48],[34,54,24,34,55,25],[20,45,15,61,46,16]];function f(){this.buffer=new Array,this.length=0}r.prototype.getRightType=function(){for(var e=1;e<41;e++){var t=d[4*(e-1)+this.errorCorrectLevel];if(void 0==t)throw new Error("bad rs block @ typeNumber:"+e+"/errorCorrectLevel:"+this.errorCorrectLevel);for(var a=t.length/3,n=0,r=0;r<a;r++){var i=t[3*r+0],o=t[3*r+2];n+=o*i}var s=e>9?2:1;if(this.utf8bytes.length+s<n||40==e){this.typeNumber=e,this.rsBlock=t,this.totalDataCount=n;break}}},f.prototype={get:function(e){var t=Math.floor(e/8);return this.buffer[t]>>>7-e%8&1},put:function(e,t){for(var a=0;a<t;a++)this.putBit(e>>>t-a-1&1)},putBit:function(e){var t=Math.floor(this.length/8);this.buffer.length<=t&&this.buffer.push(0),e&&(this.buffer[t]|=128>>>this.length%8),this.length++}}},ea91:function(e,t,a){"use strict";var n=a("4b95"),r=a.n(n);r.a},f146:function(e,t,a){"use strict";var n=a("4ea4").default,r=n(a("53ca")),i=n(a("c7eb")),o=n(a("2909")),s=n(a("5530")),l=n(a("1da1"));a("d3b7"),a("e9c4"),a("4e82"),a("a9e3"),a("3ca3"),a("ddb0"),a("c740"),a("159b"),a("a434"),a("99af"),a("cb29"),a("ac1f"),a("1276"),a("14d9"),a("00b4"),a("498a");var u=n(a("49a3")),c=n(a("e196")),d=a("a10c"),f="QSSHAREPOSTER_IDKEY";function g(e){var t=e.Context,a=e.type,n=e.posterCanvasId,r=e.reserve,o=e.bgObj,c=e.drawArray,d=e.textArray,f=e.qrCodeArray,g=e.imagesArray,v=e.setCanvasToTempFilePath,y=e.setDraw,x=e.bgScale,w=e._this,k=e.delayTimeScale,S=e.drawDelayTime,P=e.canvas2image,N=e.draw,I={Context:t,bgObj:o,type:a,bgScale:x};return k=void 0!==k?k:15,S=void 0!==S?S:100,new Promise(function(){var e=(0,l.default)((0,i.default)().mark((function e(l,x){var C,F,O;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,u.default.log("背景对象:"+JSON.stringify(o)),o&&o.path?(u.default.log("背景有图片路径"),t.drawImage(o.path,0,0,o.width,o.height)):(u.default.log("背景没有图片路径"),o.backgroundColor?(u.default.log("背景有背景颜色:"+o.backgroundColor),t.setFillStyle(o.backgroundColor),t.fillRect(0,0,o.width,o.height)):u.default.log("背景没有背景颜色")),g&&g.length>0&&A(t,g),y&&"function"==typeof y&&y(I),d&&d.length>0&&T(t,d,o),f&&f.length>0)for(C=0;C<f.length;C++)_(t,f[C]);if(!(c&&c.length>0)){e.next=45;break}F=0;case 9:if(!(F<c.length)){e.next=45;break}O=c[F],u.default.log("绘制可控层级序列, drawArrayItem:"+JSON.stringify(O)),e.t0=O.type,e.next="image"===e.t0?15:"text"===e.t0?18:"qrcode"===e.t0?21:"custom"===e.t0?24:"fillRect"===e.t0?28:"strokeRect"===e.t0?31:"roundStrokeRect"===e.t0?34:"roundFillRect"===e.t0?37:40;break;case 15:return u.default.log("绘制可控层级序列, 绘制图片"),A(t,O),e.abrupt("break",42);case 18:return u.default.log("绘制可控层级序列, 绘制文本"),T(t,O,o),e.abrupt("break",42);case 21:return u.default.log("绘制可控层级序列, 绘制二维码"),_(t,O),e.abrupt("break",42);case 24:return u.default.log("绘制可控层级序列, 绘制自定义内容"),O.setDraw&&"function"===typeof O.setDraw&&O.setDraw(t),e.abrupt("break",42);case 28:return u.default.log("绘制可控层级序列, 绘制填充直角矩形"),h(t,O),e.abrupt("break",42);case 31:return u.default.log("绘制可控层级序列, 绘制线条直角矩形"),m(t,O),e.abrupt("break",42);case 34:return u.default.log("绘制可控层级序列, 绘制线条圆角矩形"),p(t,O),e.abrupt("break",42);case 37:return u.default.log("绘制可控层级序列, 绘制填充圆角矩形"),b(t,O),e.abrupt("break",42);case 40:return u.default.log("未识别的类型"),e.abrupt("break",42);case 42:F++,e.next=9;break;case 45:setTimeout((function(){if(u.default.log("准备执行draw方法"),u.default.log("Context:"+t),!1===N)return u.default.log("draw属性为false，请自行调用canvas实例的draw方法"),void l();t.draw("boolean"==typeof r&&r,(function(){var e,t=v||{};t&&"function"==typeof t&&(t=v(o,a));uni.getSystemInfoSync().pixelRatio;var r=(0,s.default)((0,s.default)({quality:.8,fileType:"jpg"},t),{},{canvasId:n});if(!1===P)return l({setCanvasToTempFilePath:r});u.default.log("canvasToTempFilePath的data对象:"+JSON.stringify(r)),e=function(){var e=(0,s.default)((0,s.default)({},r),{},{success:function(e){l((0,s.default)((0,s.default)({},e),{},{setCanvasToTempFilePath:r}))},fail:function(e){u.default.hideLoading(),u.default.log("输出图片失败"),u.default.log("输出图片失败:"+JSON.stringify(e)),x("输出图片失败:"+JSON.stringify(e))}});uni.canvasToTempFilePath(e,w||null)};var i=0;f&&f.forEach((function(e){e.text&&(i+=Number(e.text.length))})),g&&g.forEach((function(){i+=k})),d&&d.forEach((function(){i+=k})),c&&c.forEach((function(e){switch(e.type){case"text":e.text&&(i+=e.text.length);break;case"qrcode":e.text&&(i+=2*e.text.length);break;default:i+=k;break}})),u.default.log("延时系数:"+k),u.default.log("总计延时:"+i),setTimeout(e,i)}))}),S),e.next=52;break;case 48:e.prev=48,e.t1=e["catch"](0),u.default.hideLoading(),x(e.t1);case 52:case"end":return e.stop()}}),e,null,[[0,48]])})));return function(t,a){return e.apply(this,arguments)}}())}function h(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};u.default.log("进入绘制填充直角矩形方法, drawArrayItem:"+JSON.stringify(t)),e.setFillStyle(t.backgroundColor||"black"),e.setGlobalAlpha(t.alpha||1),e.fillRect(t.dx||0,t.dy||0,t.width||0,t.height||0),e.setGlobalAlpha(1)}function m(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};e.setStrokeStyle(t.color||"black"),e.setLineWidth(t.lineWidth||1),e.strokeRect(t.dx,t.dy,t.width,t.height)}function p(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.dx,n=t.dy,r=t.width,i=t.height,o=t.r,s=t.lineWidth,l=t.color;o=o||.1*r,r<2*o&&(o=r/2),r<2*o&&(o=r/2),e.beginPath(),e.arc(a+o,n+o,o,1*Math.PI,1.5*Math.PI),e.lineTo(a+r-o,n),e.arc(a+r-o,n+o,o,1.5*Math.PI,0),e.lineTo(a+r,n+i-o),e.arc(a+r-o,n+i-o,o,0,.5*Math.PI),e.lineTo(a+o,n+i),e.arc(a+o,n+i-o,o,.5*Math.PI,1*Math.PI),e.lineTo(a,n+o),e.closePath(),e.setLineWidth(s||1),e.setStrokeStyle(l||"black"),e.stroke()}function b(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},a=t.dx,n=t.dy,r=t.width,i=t.height,o=t.r,s=t.backgroundColor;o=o||.1*r,r<2*o&&(o=r/2),r<2*o&&(o=r/2),e.beginPath(),e.arc(a+o,n+o,o,1*Math.PI,1.5*Math.PI),e.lineTo(a+r-o,n),e.arc(a+r-o,n+o,o,1.5*Math.PI,0),e.lineTo(a+r,n+i-o),e.arc(a+r-o,n+i-o,o,0,.5*Math.PI),e.lineTo(a+o,n+i),e.arc(a+o,n+i-o,o,.5*Math.PI,1*Math.PI),e.lineTo(a,n+o),e.closePath(),e.setFillStyle(s),e.fill()}function v(e,t,a){if(u.default.log("进入设置文字方法, texts:"+JSON.stringify(t)),!t||!u.default.isArray(t))return u.default.log("texts是对象"),t=y(e,t,a),u.default.log("返回texts:"+JSON.stringify(t)),t;if(u.default.log("texts是数组"),t.length>0)for(var n=0;n<t.length;n++)u.default.log("字符串信息-初始化之前:"+JSON.stringify(t[n])),t[n]=y(e,t[n],a)}function y(e,t,a){if(u.default.log("进入设置文字方法, textItem:"+JSON.stringify(t)),u.default.isNotNull_string(t.text)){t.text=String(t.text),t.alpha=void 0!==t.alpha?Number(t.alpha):1,t.color=t.color||"black",t.size=void 0!==t.size?Number(t.size):10,t.textAlign=t.textAlign||"left",t.textBaseline=t.textBaseline||"middle",t.dx=Number(t.dx)||0,t.dy=Number(t.dy)||0,t.size=Math.ceil(Number(t.size)),u.default.log("字符串信息-初始化默认值后:"+JSON.stringify(t));var n=w(e,{text:t.text,size:t.size});u.default.log("字符串信息-初始化时的文本长度:"+n);var r={};t.infoCallBack&&"function"===typeof t.infoCallBack&&(r=t.infoCallBack(n)),r.size&&(n=w(e,{text:t.text,size:t.size})),t=(0,s.default)((0,s.default)((0,s.default)({},t),r),{},{textLength:n}),u.default.log("字符串信息-infoCallBack后:"+JSON.stringify(t))}return t}function x(e,t,a){if(t.text&&t.lineFeed){u.default.log("设置换行");var n=-1,r=a.width,i=t.size,o=t.dx;if(u.default.isObject(t.lineFeed)){var l=t.lineFeed;n=void 0!==l.lineNum&&"number"===typeof l.lineNum&&l.lineNum>=0?l.lineNum:n,r=void 0!==l.maxWidth&&"number"===typeof l.maxWidth?l.maxWidth:r,i=void 0!==l.lineHeight&&"number"===typeof l.lineHeight?l.lineHeight:i,o=void 0!==l.dx&&"number"===typeof l.dx?l.dx:o}u.default.lineFeedTags.forEach((function(e){t.text=t.text.split(e).join(u.default.tagetLineFeedTag)}));for(var c=t.text.split(""),d="",f=[],g=0,h=c.length;g<h;g++)c[g]!==u.default.tagetLineFeedTag?w(e,{text:d,size:t.size})<=r&&w(e,{text:d+c[g],size:t.size})<=r?(d+=c[g],g==c.length-1&&f.push(d)):(f.push(d),d=c[g],g==c.length-1&&f.push(c[g])):(f.push(d),d=c[++g]);u.default.log("循环出的文本数组:"+JSON.stringify(f));for(var m=n>=0&&n<f.length?n:f.length,p=[],b=0;b<m;b++){var v=f[b];b==m-1&&m<f.length&&f.length>1&&w(e,{text:v,size:t.size})>.9*(r-t.size)&&(v=v.substring(0,v.length-1)+"...");var y=(0,s.default)((0,s.default)({},t),{},{text:v,dx:0===b?t.dx:o>=0?o:t.dx,dy:t.dy+b*i,textLength:w(e,{text:v,size:t.size})});u.default.log("重新组成的文本对象:"+JSON.stringify(y)),p.push(y)}u.default.log("newArr: -----",JSON.stringify(p));var x=p.length>1?p:p[0];return x}return t}function w(e,t){u.default.log("计算文字长度, obj:"+JSON.stringify(t));var a,n=t.text,r=t.size;e.setFontSize(r);try{a=e.measureText(n)}catch(c){a={}}if(u.default.log("measureText计算文字长度, textLength:"+JSON.stringify(a)),a=a&&a.width?a.width:0,!a){for(var i=0,o=0;o<n.length;o++){var s=n.substr(o,1),l=k(s);u.default.log("计算文字宽度系数:"+l),i+=l}u.default.log("文字宽度总系数:"+i),a=i*r}return a}function k(e){var t;return t=/a/.test(e)?.552734375:/b/.test(e)?.638671875:/c/.test(e)?.50146484375:/d/.test(e)?.6396484375:/e/.test(e)?.5673828125:/f/.test(e)?.3466796875:/g/.test(e)?.6396484375:/h/.test(e)?.61572265625:/i/.test(e)?.26611328125:/j/.test(e)?.26708984375:/k/.test(e)?.54443359375:/l/.test(e)?.26611328125:/m/.test(e)?.93701171875:/n/.test(e)?.6162109375:/o/.test(e)?.6357421875:/p/.test(e)?.638671875:/q/.test(e)?.6396484375:/r/.test(e)?.3818359375:/s/.test(e)?.462890625:/t/.test(e)?.37255859375:/u/.test(e)?.6162109375:/v/.test(e)?.52490234375:/w/.test(e)?.78955078125:/x/.test(e)?.5068359375:/y/.test(e)?.529296875:/z/.test(e)?.49169921875:/A/.test(e)?.70361328125:/B/.test(e)?.62744140625:/C/.test(e)?.6689453125:/D/.test(e)?.76171875:/E/.test(e)?.5498046875:/F/.test(e)?.53125:/G/.test(e)?.74365234375:/H/.test(e)?.7734375:/I/.test(e)?.2939453125:/J/.test(e)?.39599609375:/K/.test(e)?.634765625:/L/.test(e)?.51318359375:/M/.test(e)?.97705078125:/N/.test(e)?.81298828125:/O/.test(e)?.81494140625:/P/.test(e)?.61181640625:/Q/.test(e)?.81494140625:/R/.test(e)?.65283203125:/S/.test(e)?.5771484375:/T/.test(e)?.5732421875:/U/.test(e)?.74658203125:/V/.test(e)?.67626953125:/W/.test(e)?1.017578125:/X/.test(e)?.64501953125:/Y/.test(e)?.603515625:/Z/.test(e)?.6201171875:/[0-9]/.test(e)?.58642578125:/[\u4e00-\u9fa5]/.test(e)?1:/ /.test(e)?.2958984375:/\`/.test(e)?.294921875:/\~/.test(e)?.74169921875:/\!/.test(e)?.3125:/\@/.test(e)?1.03125:/\#/.test(e)?.63818359375:/\$/.test(e)?.58642578125:/\%/.test(e)?.8896484375:/\^/.test(e)?.74169921875:/\&/.test(e)?.8701171875:/\*/.test(e)?.455078125:/\(/.test(e)||/\)/.test(e)?.333984375:/\_/.test(e)?.4482421875:/\-/.test(e)?.4326171875:/\+/.test(e)||/\=/.test(e)?.74169921875:/\|/.test(e)?.26904296875:/\\/.test(e)?.416015625:/\[/.test(e)||/\]/.test(e)?.333984375:/\;/.test(e)?.24072265625:/\'/.test(e)?.25634765625:/\,/.test(e)||/\./.test(e)?.24072265625:/\//.test(e)?.42724609375:/\{/.test(e)||/\}/.test(e)?.333984375:/\:/.test(e)?.24072265625:/\"/.test(e)?.435546875:/\</.test(e)||/\>/.test(e)?.74169921875:/\?/.test(e)?.48291015625:1,t}function S(e){return u.default.log("进入设置图片数据方法"),new Promise(function(){var t=(0,l.default)((0,i.default)().mark((function t(a,n){var r;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!e||!u.default.isArray(e)){t.next=14;break}u.default.log("images是一个数组"),r=0;case 4:if(!(r<e.length)){t.next=12;break}return u.default.log("设置图片数据循环中:"+r),t.next=8,N(e[r]);case 8:e[r]=t.sent;case 9:r++,t.next=4;break;case 12:t.next=18;break;case 14:return u.default.log("images是一个对象"),t.next=17,N(e);case 17:e=t.sent;case 18:a(e),t.next=25;break;case 21:t.prev=21,t.t0=t["catch"](0),u.default.hideLoading(),n(t.t0);case 25:case"end":return t.stop()}}),t,null,[[0,21]])})));return function(e,a){return t.apply(this,arguments)}}())}function P(e){return/^\s*data:([a-z]+\/[a-z0-9-+.]+(;[a-z-]+=[a-z0-9-]+)?)?(;base64)?,([a-z0-9!$&',()*+;=\-._~:@\/?%\s]*?)\s*$/i.test(e)?(0,d.base64ToPath)(e):Promise.resolve(e)}function N(e){return new Promise(function(){var t=(0,l.default)((0,i.default)().mark((function t(a,n){var r,o,l,c;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,!e.url){t.next=22;break}return t.next=4,P(e.url);case 4:return e.url=t.sent,r=e.url,o=r,t.next=9,u.default.downloadFile_PromiseFc(r);case 9:return r=t.sent,e.url=r,l=e.infoCallBack&&"function"===typeof e.infoCallBack,c={},t.next=15,u.default.getImageInfo_PromiseFc(o);case 15:c=t.sent,l&&(e=(0,s.default)((0,s.default)({},e),e.infoCallBack(c))),e.dx=Number(e.dx)||0,e.dy=Number(e.dy)||0,e.dWidth=Number(e.dWidth||c.width),e.dHeight=Number(e.dHeight||c.height),e=(0,s.default)((0,s.default)({},e),{},{imageInfo:c});case 22:a(e),t.next=29;break;case 25:t.prev=25,t.t0=t["catch"](0),u.default.hideLoading(),n(t.t0);case 29:case"end":return t.stop()}}),t,null,[[0,25]])})));return function(e,a){return t.apply(this,arguments)}}())}function T(e,t,a){u.default.isArray(t)?u.default.log("遍历文本方法, 是数组"):(u.default.log("遍历文本方法, 不是数组"),t=[t]),u.default.log("遍历文本方法, textArray:"+JSON.stringify(t));var n=t;u.default.log("绘制文本新数组:"+JSON.stringify(n)),function(e,t){if(u.default.log("准备绘制文本方法, texts:"+JSON.stringify(t)),t&&u.default.isArray(t)){if(u.default.log("准备绘制文本方法, 是数组"),t.length>0)for(var a=0;a<t.length;a++)I(e,t[a])}else u.default.log("准备绘制文本方法, 不是数组"),I(e,t)}(e,n)}function I(e,t){if(u.default.log("进入绘制文本方法, textItem:"+JSON.stringify(t)),t&&u.default.isObject(t)&&t.text){if(e.font=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};if(e.font&&"string"===typeof e.font)return u.default.log(e.font),e.font;var t="normal",a="normal",n="normal",r=e.size||10,i="sans-serif";return r=Math.ceil(Number(r)),e.fontStyle&&"string"===typeof e.fontStyle&&(t=e.fontStyle.trim()),e.fontVariant&&"string"===typeof e.fontVariant&&(a=e.fontVariant.trim()),!e.fontWeight||"string"!==typeof e.fontWeight&&"number"!==typeof e.fontWeight||(n=e.fontWeight.trim()),e.fontFamily&&"string"===typeof e.fontFamily&&(i=e.fontFamily.trim()),t+" "+a+" "+n+" "+r+"px "+i}(t),e.setFillStyle(t.color),e.setGlobalAlpha(t.alpha),e.setTextAlign(t.textAlign),e.setTextBaseline(t.textBaseline),e.fillText(t.text,t.dx,t.dy),t.lineThrough&&u.default.isObject(t.lineThrough)){u.default.log("有删除线");var a,n,r=t.lineThrough;switch(r.alpha=void 0!==r.alpha?r.alpha:t.alpha,r.style=r.style||t.color,r.width=void 0!==r.width?r.width:t.size/10,r.cap=void 0!==r.cap?r.cap:"butt",u.default.log("删除线对象:"+JSON.stringify(r)),e.setGlobalAlpha(r.alpha),e.setStrokeStyle(r.style),e.setLineWidth(r.width),e.setLineCap(r.cap),t.textAlign){case"left":a=t.dx;break;case"center":a=t.dx-t.textLength/2;break;default:a=t.dx-t.textLength;break}switch(t.textBaseline){case"top":n=t.dy+.5*t.size;break;case"middle":n=t.dy;break;default:n=t.dy-.5*t.size;break}e.beginPath(),e.moveTo(a,n),e.lineTo(a+t.textLength,n),e.stroke(),e.closePath(),u.default.log("删除线完毕")}e.setGlobalAlpha(1),e.font="10px sans-serif"}}function A(e,t){if(u.default.log("判断图片数据类型:"+JSON.stringify(t)),t&&u.default.isArray(t)){if(t.length>0)for(var a=0;a<t.length;a++)C(e,t[a])}else C(e,t)}function C(e,t){u.default.log("判断绘制图片形状, img:"+JSON.stringify(t)),t.url&&(t.circleSet?function(e,t){u.default.log("进入绘制圆形图片方法, obj:"+JSON.stringify(t));var a,n,i,o=t.dx,s=t.dy,l=t.dWidth,c=t.dHeight,d=t.circleSet;t.imageInfo;"object"===(0,r.default)(d)&&(a=d.x,n=d.y,i=d.r);if(!i){var f;f=l>c?c:l,i=f/2}a=a?o+a:(o||0)+i,n=n?s+n:(s||0)+i,e.save(),e.beginPath(),e.arc(a,n,i,0,2*Math.PI,!1),e.closePath(),e.setGlobalAlpha(0),e.fillStyle="#FFFFFF",e.fill(),e.setGlobalAlpha(1),e.clip(),O(e,t),u.default.log("默认图片绘制完毕"),e.restore()}(e,t):t.roundRectSet?function(e,t){u.default.log("进入绘制矩形图片方法, obj:"+JSON.stringify(t)),e.save();var a,n=t.dx,i=t.dy,o=t.dWidth,s=t.dHeight,l=t.roundRectSet;t.imageInfo;"object"===(0,r.default)(l)&&(a=l.r);a=a||.1*o,o<2*a&&(a=o/2);s<2*a&&(a=s/2);e.beginPath(),e.arc(n+a,i+a,a,1*Math.PI,1.5*Math.PI),e.lineTo(n+o-a,i),e.arc(n+o-a,i+a,a,1.5*Math.PI,0),e.lineTo(n+o,i+s-a),e.arc(n+o-a,i+s-a,a,0,.5*Math.PI),e.lineTo(n+a,i+s),e.arc(n+a,i+s-a,a,.5*Math.PI,1*Math.PI),e.lineTo(n,i+a),e.closePath(),e.setGlobalAlpha(0),e.fillStyle="#FFFFFF",e.fill(),e.setGlobalAlpha(1),e.clip(),O(e,t),e.restore(),u.default.log("进入绘制矩形图片方法, 绘制完毕")}(e,t):O(e,t))}var F={scaleToFill:function(e,t){u.default.log("准备绘制mode为scaleToFill的图片"),e.drawImage(t.url,Number(t.dx||0),Number(t.dy||0),Number(t.dWidth)||!1,Number(t.dHeight)||!1),u.default.log("mode为scaleToFill的图片绘制完毕")},aspectFit:function(e,t){u.default.log("准备绘制mode为aspectFit的图片");var a=t.imageInfo,n=t.dWidth,r=t.dHeight,i=a.height,o=a.width,s=n,l=i/o*s;if(l<r){var c=(Number(r)-Number(l))/Number(r)*i;t.dy=Number(t.dy)+c/2}else{l=r,s=o/i*l;var d=(Number(n)-Number(s))/Number(n)*o;t.dx=Number(t.dx)+d/2}e.drawImage(t.url,0,0,o,i,t.dx,t.dy,s,l),u.default.log("mode为aspectFit的图片绘制完毕")},aspectFill:function(e,t){uni.getSystemInfoSync().pixelRatio;u.default.log("准备绘制mode为aspectFill的图片");var a=t.imageInfo,n=t.dWidth,r=t.dHeight,i=a.height,o=a.width,s=0,l=0,c=o,d=i,f=n,g=i/o*f;if(g<r){u.default.log("绘制高度 小于 预定高度"),g=r,f=o/i*g;var h=(Number(f)-Number(n))/Number(f)*o;s=h/2,c=o-h}else{var m=(Number(g)-Number(r))/Number(g)*i;l=m/2,d=i-m}u.default.log("aspectFill 最终绘制: sx: ".concat(s,", sy: ").concat(l,", sWidth: ").concat(c,", sHeight: ").concat(d,", dx: ").concat(t.dx,", dy: ").concat(t.dy,", dWidth: ").concat(n,", dHeight: ").concat(r)),e.drawImage(t.url,s,l,c,d,t.dx,t.dy,n,r),u.default.log("mode为aspectFill的图片绘制完毕")}};function O(e,t){if(u.default.log("进入绘制默认图片方法, img:"+JSON.stringify(t)),t.url){var a=!u.default.isUndef(t.alpha);t.alpha=Number(u.default.isUndef(t.alpha)?1:t.alpha),e.setGlobalAlpha(t.alpha),u.default.log("绘制默认图片方法, 有url"),void 0===t.dHeight&&(t.dHeight=t.imageInfo.height),void 0===t.dWidth&&(t.dWidth=t.imageInfo.width);var n=F[t.mode];n?n(e,t):t.dWidth&&t.dHeight&&t.sx&&t.sy&&t.sWidth&&t.sHeight?(u.default.log("绘制默认图片方法, 绘制第一种方案"),e.drawImage(t.url,Number(t.sx)||!1,Number(t.sy)||!1,Number(t.sWidth)||!1,Number(t.sHeight)||!1,Number(t.dx||0),Number(t.dy||0),Number(t.dWidth)||!1,Number(t.dHeight)||!1)):t.dWidth&&t.dHeight?(u.default.log("绘制默认图片方法, 绘制第二种方案"),e.drawImage(t.url,Number(t.dx||0),Number(t.dy||0),Number(t.dWidth)||!1,Number(t.dHeight)||!1)):(u.default.log("绘制默认图片方法, 绘制第三种方案"),e.drawImage(t.url,Number(t.dx||0),Number(t.dy||0))),a&&e.setGlobalAlpha(1)}u.default.log("绘制默认图片方法, 绘制完毕")}function _(e,t){u.default.log("进入绘制二维码方法");for(var a=[],n={text:String(t.text||"")||"",size:Number(t.size||0)||200,background:String(t.background||"")||"#ffffff",foreground:String(t.foreground||"")||"#000000",pdground:String(t.pdground||"")||"#000000",correctLevel:Number(t.correctLevel||0)||3,image:String(t.image||"")||"",imageSize:Number(t.imageSize||0)||40,dx:Number(t.dx||0)||0,dy:Number(t.dy||0)||0},r=null,i=0,o=0,s=a.length;o<s;o++)if(i=o,a[o].text==n.text&&a[o].text.correctLevel==n.correctLevel){r=a[o].obj;break}i==s&&(r=new c.default(n.text,n.correctLevel),a.push({text:n.text,correctLevel:n.correctLevel,obj:r}));for(var l=function(e){var t=e.options;return t.pdground&&(e.row>1&&e.row<5&&e.col>1&&e.col<5||e.row>e.count-6&&e.row<e.count-2&&e.col>1&&e.col<5||e.row>1&&e.row<5&&e.col>e.count-6&&e.col<e.count-2)?t.pdground:t.foreground},d=r.getModuleCount(),f=n.size,g=n.imageSize,h=(f/d).toPrecision(4),m=(f/d).toPrecision(4),p=0;p<d;p++)for(var b=0;b<d;b++){var v=Math.ceil((b+1)*h)-Math.floor(b*h),y=Math.ceil((p+1)*h)-Math.floor(p*h),x=l({row:p,col:b,count:d,options:n});e.setFillStyle(r.modules[p][b]?x:n.background),e.fillRect(n.dx+Math.round(b*h),n.dy+Math.round(p*m),v,y)}if(n.image){var w=n.dx+Number(((f-g)/2).toFixed(2)),k=n.dy+Number(((f-g)/2).toFixed(2));(function(e,t,a,r,i,o,s,l,u){e.setLineWidth(s),e.setFillStyle(n.background),e.setStrokeStyle(n.background),e.beginPath(),e.moveTo(t+o,a),e.arcTo(t+r,a,t+r,a+o,o),e.arcTo(t+r,a+i,t+r-o,a+i,o),e.arcTo(t,a+i,t,a+i-o,o),e.arcTo(t,a,t+o,a,o),e.closePath(),l&&e.fill(),u&&e.stroke()})(e,w,k,g,g,2,6,!0,!0),e.drawImage(n.image,w,k,g,g)}u.default.log("进入绘制二维码方法完毕")}function L(e){e.backgroundImage,e.type;return new Promise(function(){var t=(0,l.default)((0,i.default)().mark((function t(a,n){var r;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,E(e);case 3:r=t.sent,a(r),t.next=13;break;case 7:t.prev=7,t.t0=t["catch"](0),u.default.hideLoading(),u.default.showToast("获取分享用户背景图失败:"+JSON.stringify(t.t0)),u.default.log(JSON.stringify(t.t0)),n(t.t0);case 13:case"end":return t.stop()}}),t,null,[[0,7]])})));return function(e,a){return t.apply(this,arguments)}}())}function E(e,t){var a=e.backgroundImage;e.type;return u.default.log("获取分享背景图, 尝试清空本地数据"),new Promise(function(){var t=(0,l.default)((0,i.default)().mark((function t(n,r){var o,l,c,d;return(0,i.default)().wrap((function(t){while(1)switch(t.prev=t.next){case 0:if(t.prev=0,u.default.log("没有从后端获取的背景图片路径, 尝试从后端获取背景图片路径"),!a){t.next=6;break}t.t0=a,t.next=9;break;case 6:return t.next=8,u.default.getPosterUrl(e);case 8:t.t0=t.sent;case 9:return o=t.t0,t.next=12,P(o);case 12:return o=t.sent,u.default.log("尝试下载并保存背景图:"+o),t.next=16,u.default.downLoadAndSaveFile_PromiseFc(o);case 16:if(l=t.sent,!l){t.next=29;break}return u.default.log("下载并保存背景图成功:"+l),t.next=21,u.default.getImageInfo_PromiseFc(o);case 21:c=t.sent,u.default.log("获取图片信息成功"),d={path:l,width:c.width,height:c.height,name:u.default.fileNameInPath(o)},u.default.log("拼接背景图信息对象成功:"+JSON.stringify(d)),u.default.log("返回背景图信息对象"),n((0,s.default)({},d)),t.next=30;break;case 29:r("not find savedFilePath");case 30:t.next=36;break;case 32:t.prev=32,t.t1=t["catch"](0),u.default.hideLoading(),r(t.t1);case 36:case"end":return t.stop()}}),t,null,[[0,32]])})));return function(e,a){return t.apply(this,arguments)}}())}e.exports={getShreUserPosterBackground:L,getSharePoster:function(e){var t=e.type,a=e.formData,n=e.background,r=e.posterCanvasId,c=e.backgroundImage,d=e.reserve,h=e.textArray,m=e.drawArray,p=e.qrCodeArray,b=e.imagesArray,y=e.setCanvasWH,k=e.setCanvasToTempFilePath,P=e.canvas2image,N=e.setDraw,T=e.bgScale,I=e.Context,A=e._this,C=e.delayTimeScale,F=e.drawDelayTime,O=e.draw;return new Promise(function(){var e=(0,l.default)((0,i.default)().mark((function e(l,_){var E,B,M,z,j,R,D,H,W,J,G,U;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(e.prev=0,I||(u.default.log("没有画布对象,创建画布对象"),I=uni.createCanvasContext(r,A||null)),!(n&&n.width&&n.height)){e.next=6;break}E=n,e.next=9;break;case 6:return e.next=8,L({backgroundImage:c,type:t,formData:a});case 8:E=e.sent;case 9:if(T=T||1,E.width=E.width*T,E.height=E.height*T,u.default.log("获取背景图信息对象成功:"+JSON.stringify(E)),B={bgObj:E,type:t,bgScale:T,getBgObj:function(){return B.bgObj},setBgObj:function(e){var t=(0,s.default)((0,s.default)({},B.bgObj),e);B.bgObj=t,E=t}},!b){e.next=20;break}return"function"==typeof b&&(b=b(B)),u.default.log("准备设置图片"),e.next=19,S(b);case 19:b=e.sent;case 20:if(h&&("function"==typeof h&&(h=h(B)),h=v(I,h)),!p){e.next=33;break}"function"==typeof p&&(p=p(B)),M=0;case 24:if(!(M<p.length)){e.next=33;break}if(u.default.log(M),!p[M].image){e.next=30;break}return e.next=29,u.default.downloadFile_PromiseFc(p[M].image);case 29:p[M].image=e.sent;case 30:M++,e.next=24;break;case 33:if(!m){e.next=91;break}if("function"==typeof m&&(m=m(B)),!u.default.isPromise(m)){e.next=39;break}return e.next=38,m;case 38:m=e.sent;case 39:if(!(u.default.isArray(m)&&m.length>0)){e.next=91;break}[],z=0;case 42:if(!(z<m.length)){e.next=74;break}j=m[z],j[f]=z,R=void 0,D=!1,e.t0=j.type,e.next="image"===e.t0?50:"text"===e.t0?54:"qrcode"===e.t0?56:"custom"===e.t0?62:"fillrect"===e.t0?63:"strokeRect"===e.t0?64:"roundStrokeRect"===e.t0?65:"roundFillRect"===e.t0?66:67;break;case 50:return e.next=52,S(j);case 52:return R=e.sent,e.abrupt("break",69);case 54:return R=v(I,j,B.bgObj),e.abrupt("break",69);case 56:if(!j.image){e.next=61;break}return e.next=59,u.default.downloadFile_PromiseFc(j.image);case 59:e.t1=e.sent,R={image:e.t1};case 61:return e.abrupt("break",69);case 62:return e.abrupt("break",69);case 63:return e.abrupt("break",69);case 64:return e.abrupt("break",69);case 65:return e.abrupt("break",69);case 66:return e.abrupt("break",69);case 67:return u.default.log("未识别的类型"),e.abrupt("break",69);case 69:!D&&R&&u.default.isObject(R)&&(m[z]=(0,s.default)((0,s.default)({},j),R));case 71:z++,e.next=42;break;case 74:u.default.log("AllInfoCallback之前",JSON.stringify(m)),u.default.log("----------------hasAllInfoCallback----------------"),H=(0,o.default)(m),H.sort((function(e,t){var a=u.default.isUndef(e.serialNum)||u.default.isNull(e.serialNum)?Number.NEGATIVE_INFINITY:Number(e.serialNum),n=u.default.isUndef(t.serialNum)||u.default.isNull(t.serialNum)?Number.NEGATIVE_INFINITY:Number(t.serialNum);return a-n})),u.default.log("开始for循环"),W=(0,i.default)().mark((function e(t){var a,n,r,l,c,d,g;return(0,i.default)().wrap((function(e){while(1)switch(e.prev=e.next){case 0:if(a=(0,s.default)({},H[t]),n=a[f],u.default.log("item_idKey",n),r=m.findIndex((function(e){return e[f]==n})),u.default.log("ind",r),-1!=r){e.next=7;break}return e.abrupt("return","break");case 7:if(!u.default.isFn(a.allInfoCallback)){e.next=16;break}if(l=a.allInfoCallback({drawArray:m}),u.default.log("newData",JSON.stringify(l)),!u.default.isPromise(l)){e.next=14;break}return e.next=13,l;case 13:l=e.sent;case 14:"text"===m[r].type&&l.size&&(c=w(I,{text:l.text||m[r].text,size:l.size}),l.textLength=c),m[r]=(0,s.default)((0,s.default)({},a),l);case 16:u.default.log("drawArray[ind]",JSON.stringify(m[r])),"text"===m[r].type&&(d=x(I,m[r],B.bgObj),u.default.isArray(d)?(d.forEach((function(e,t){e[f]=m.length+t,e.allInfoCallback=null})),(g=m).splice.apply(g,[r,1].concat((0,o.default)(d)))):m.splice(r,1,d));case 18:case"end":return e.stop()}}),e)})),J=0;case 81:if(!(J<H.length)){e.next=89;break}return e.delegateYield(W(J),"t2",83);case 83:if(G=e.t2,"break"!==G){e.next=86;break}return e.abrupt("break",89);case 86:J++,e.next=81;break;case 89:u.default.log("for循环结束"),u.default.log("allInfocallback结束",JSON.stringify(m));case 91:if(m.sort((function(e,t){var a=u.default.isUndef(e.zIndex)||u.default.isNull(e.zIndex)?Number.NEGATIVE_INFINITY:Number(e.zIndex),n=u.default.isUndef(t.zIndex)||u.default.isNull(t.zIndex)?Number.NEGATIVE_INFINITY:Number(t.zIndex);return a-n})),u.default.log("params:"+JSON.stringify(B)),!y||"function"!=typeof y){e.next=96;break}return e.next=96,new Promise((function(e,t){y(B),setTimeout((function(){e()}),50)}));case 96:return e.next=98,g({Context:I,type:t,posterCanvasId:r,reserve:d,drawArray:m,textArray:h,imagesArray:b,bgObj:E,qrCodeArray:p,setCanvasToTempFilePath:k,setDraw:N,bgScale:T,_this:A,delayTimeScale:C,drawDelayTime:F,canvas2image:P,draw:O});case 98:U=e.sent,l({bgObj:E,poster:U,type:t}),e.next=106;break;case 102:e.prev=102,e.t3=e["catch"](0),u.default.hideLoading(),_(e.t3);case 106:case"end":return e.stop()}}),e,null,[[0,102]])})));return function(t,a){return e.apply(this,arguments)}}())},setText:v,setImage:S,drawText:T,drawImage:A,drawQrCode:_,drawFillRect:h,drawStrokeRect:m,drawRoundStrokeRect:p,drawRoundFillRect:b}},fb07:function(e,t,a){"use strict";var n=a("c565"),r=a.n(n);r.a}}]);